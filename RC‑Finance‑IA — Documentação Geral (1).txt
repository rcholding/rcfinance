# RCâ€‘Financeâ€‘IA â€” DocumentaÃ§Ã£o Geral

> **VisÃ£o geral completa** do estado atual do projeto, histÃ³rico de decisÃµes, arquitetura de pastas, fases concluÃ­das e roadâ€‘map futuro. Use este documento como referÃªncia Ãºnica para onboarding e continuidade dos trabalhos.

---

## 1. Objetivo do Projeto

Construir um **gerenciador financeiro assistido por IA** que opere *localmente* (WindowsÂ 10, CPU AMDÂ AthlonÂ 320GE, 16â€¯GBÂ RAM) com as seguintes metas:

1. **Registro rÃ¡pido de transaÃ§Ãµes**Â (income/expense) manual ou por importaÃ§Ã£o (CSV/JSON/OCR/voz).
2. **Metas financeiras inteligentes** com priorizaÃ§Ã£o automÃ¡tica e recomendaÃ§Ãµes de alocaÃ§Ã£o.
3. **Dashboard de fluxo de caixa** e indicadores chave.
4. **IAÂ classificadora** para categoria automÃ¡tica de despesas/receitas.
5. **Interface Streamlit** (leve, amigÃ¡vel, darkâ€‘theme) e banco SQLite (sqliteâ€‘utils).
6. Caminho de evoluÃ§Ã£o: comandos por voz â†’ integraÃ§Ã£o openâ€‘finance â†’ deploy opcional (StreamlitÂ Cloud / Docker).

---

## 2. Linha do Tempo & Fases

| Fase  | Data           | Status | Entregas chave                                                                                                      |
| ----- | -------------- | ------ | ------------------------------------------------------------------------------------------------------------------- |
| **0** | JulÂ 27Â 2025    | âœ…      | IdeaÃ§Ã£o, coleta de requisitos do usuÃ¡rio, exportÂ JSONÂ backup (transaÃ§Ãµes/goals)                                     |
| **1** | AgoÂ 05Â 2025    | âœ…      | Ambiente MinicondaÂ (`iafinance`), VSÂ Code, dependÃªnciasÂ `fastapiÂ uvicornÂ streamlitÂ sqlite-utilsÂ pandasÂ pytesseract` |
| **2** | AgoÂ 06Â 2025    | âœ…      | CRUD de **TransaÃ§Ãµes** + IAÂ categoria (`utils/ai_classifier.py`), Dashboard inicial (matplotlib)                    |
| **3** | AgoÂ 06â€‘07Â 2025 | ğŸš§     | ImportaÃ§Ã£o CSV/JSON, OCR viaÂ Tesseract, ediÃ§Ã£o de transaÃ§Ãµes (documento â€œFase3Â ImportacaoÂ IAâ€)                      |
| **4** | â€‘â€‘             | â³      | MÃ³dulo completo de **Metas inteligentes** (prioridade, alertas)                                                     |
| **5** | â€‘â€‘             | â³      | Speechâ€‘toâ€‘TextÂ (Whisper) para input por voz                                                                         |
| **6** | â€‘â€‘             | â³      | IntegraÃ§Ã£o openâ€‘finance / APIs bancÃ¡rias                                                                            |
| **7** | â€‘â€‘             | â³      | Empacotamento Docker + deploy opcional                                                                              |

Legenda: âœ…Â concluÃ­doâ€ƒğŸš§Â em andamentoâ€ƒâ³Â planejado

---

## 3. Estrutura de Pastas (repo local `C:\RCâ€‘Financeâ€‘IA`)

```
RCâ€‘Financeâ€‘IA/
â”œâ”€ data/
â”‚  â””â”€ finance.db          # SQLite gerenciado por sqliteâ€‘utils
â”œâ”€ scripts/
â”‚  â”œâ”€ ui.py               # App Streamlit principal
â”‚  â”œâ”€ utils/
â”‚  â”‚  â”œâ”€ ai_classifier.py  # Sugere categoria via ML leve
â”‚  â”‚  â””â”€ ocr_reader.py     # Wrapper Tesseract OCR
â”‚  â””â”€ init_db.py          # Cria tabelas (transactions, goals)
â”œâ”€ env/                   # (reservado p/ virtual env snapshots)
â”œâ”€ README.md
â””â”€ docs/                  # (gerado pelo Canvas)
```

---

## 4. Tecnologias & Bibliotecas

| Camada     | Stack                                    | FunÃ§Ã£o                              |
| ---------- | ---------------------------------------- | ----------------------------------- |
| *Frontend* | **Streamlit**Â 1.36Â (darkâ€‘theme)          | UI reativa, sidebar, forms          |
| *Backend*  | **sqliteâ€‘utils**                         | ORMÂ mÃ­nimo + migrations             |
| *IA*       | `sentence-transformersÂ all-MiniLM-L6-v2` | Embeddings p/ classificar categoria |
| *OCR*      | **TesseractÂ 5.3.4** + `pytesseract`      | ExtraÃ§Ã£o de texto de imagens/PDFs   |
| *GrÃ¡ficos* | **matplotlib**                           | Fluxo de caixa diÃ¡rio               |

---

## 5. Resumo do CÃ³digo Atual (v0.3)

### `scripts/ui.py`

- PÃ¡ginas: **TransaÃ§Ãµes** | **Metas** | **Dashboard**
- `st.experimental_rerun()` substituÃ­do por `st.rerun()` (compat. StreamlitÂ >=1.30)
- Classe utilitÃ¡ria `classify_transaction(desc)` importada de `utils.ai_classifier`.
- Import CSV/JSONÂ â†’ DataFrameÂ â†’ inserÃ§Ã£o `db["goals"].insert(...)`.
- OCR stub chamando `utils.ocr_reader.extract_text_from_image()`.

### `utils/ai_classifier.py`

```python
from sentence_transformers import SentenceTransformer, util
model = SentenceTransformer("all-MiniLM-L6-v2")
TAGS = ["alimentaÃ§Ã£o","saÃºde","lazer","moradia","transporte","investimento"]

def classify_transaction(desc: str) -> str:
    emb = model.encode(desc, convert_to_tensor=True)
    scores = [util.cos_sim(emb, model.encode(t))[0][0] for t in TAGS]
    return TAGS[int(max(range(len(scores)), key=scores.__getitem__))]
```

### `utils/ocr_reader.py`

- Configura `pytesseract.tesseract_cmd` com caminho absoluto.
- FunÃ§Ã£o retorna texto UTFâ€‘8 (langÂ `por`).

---

## 6. Bugs / PendÃªncias Atuais

1. **Mensagem de erro** `AttributeError: module 'streamlit' has no attribute 'experimental_rerun'` â€“Â corrigido trocando por `st.rerun()`.
2. **Dashboard eixo x** desalinhado: indexÂ `date` precisa de `df.sort_index()` antes de plotar.
3. **Metas â€“Â Cadastrar/Importar/OCR** marcados como "Funcionalidade em construÃ§Ã£o" (FaseÂ 3).

---

## 7. PrÃ³ximas Tarefas (detalhe)

| #   | AÃ§Ã£o                              | Arquivo                     | Dica Copiarâ€‘eâ€‘Colar                                         |
| --- | --------------------------------- | --------------------------- | ----------------------------------------------------------- |
| 3.1 | Finalizar uploadÂ CSV/JSON         | `ui.py` (aba Importar)      | see bloco **ImportaÃ§Ã£o de CSV/JSON** no doc "Fase3"         |
| 3.2 | Integrar OCRÂ PDF (pdf2image)      | `utils/ocr_reader.py`       | converter PDF â†’ PNG â†’ `extract_text_from_image`             |
| 3.3 | FormulÃ¡rio "CadastrarÂ Meta"       | `ui.py` (aba Cadastrar)     | campos: `name`, `target`, `current`, `priority`, `deadline` |
| 3.4 | EdiÃ§Ã£o/ExclusÃ£o de Metas          | `ui.py`                     | usar `db["goals"].update()` e `delete()`                    |
| 4.1 | Algoritmo de alocaÃ§Ã£o inteligente | `utils/allocator.py` (novo) | heurÃ­stica 50â€‘30â€‘20 + prioridades                           |
| 4.2 | BotÃ£o â€œGerar planoâ€               | `Dashboard`                 | retorna sugeridas via allocator                             |

---

## 8. FAQ de Desenvolvimento RÃ¡pido

1. **Como resetar o DB?**
   ```powershell
   del data\finance.db & python scripts\init_db.py
   ```
2. **Erro Tesseract path?** Verifique `pytesseract.pytesseract.tesseract_cmd`.
3. **Atualizar dependÃªncias?** `pip install -U streamlit pandas matplotlib pytesseract`.

---

## 9. ConclusÃ£o

O nÃºcleo transacional estÃ¡ sÃ³lido (CRUD + IA). A FaseÂ 3 adicionarÃ¡ importaÃ§Ãµes e OCR para acelerar entrada de dados. Em seguida, avanÃ§aremos para metas inteligentes e automaÃ§Ãµes. Este documento serÃ¡ atualizado a cada marco.

> **Ãšltima atualizaÃ§Ã£o:** 07Â agoÂ 2025 â€” ChatGPT RCâ€‘Financeâ€‘IA assistant.

